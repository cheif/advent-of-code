import Foundation
import Shared

private func parse(input: String) -> [(springs: [Character], broken: [Int])] {
    return input.split(whereSeparator: \.isNewline)
        .map { line in
            let splits = line.split(whereSeparator: \.isWhitespace)
            return (
                springs: splits[0].map { $0 },
                broken: splits[1].split(separator: ",").map { Int($0)! }
            )
        }
}

private func arrangements(springs: [Character], broken: [Int]) -> Int {
    if springs.isEmpty {
        return broken.isEmpty ? 1 : 0
    }
    switch springs.first {
    case ".": return arrangements(springs: Array(springs.dropFirst()), broken: broken)
    case "#": return handleGroupsCached(springs: springs, broken: broken)
    case "?": return arrangements(springs: Array(springs.dropFirst()), broken: broken) + handleGroupsCached(springs: springs, broken: broken)
    default: fatalError()
    }
}

struct CacheKey: Hashable {
    let springs: [Character]
    let broken: [Int]
}
var groupCache: [CacheKey: Int] = [:]
private func handleGroupsCached(springs: [Character], broken: [Int]) -> Int {
    let cacheKey = CacheKey(springs: springs, broken: broken)
    if let cached = groupCache[cacheKey] {
        return cached
    }
    let res = handleGroups(springs: springs, broken: broken)
    groupCache[cacheKey] = res
    return res
}

private func handleGroups(springs: [Character], broken: [Int]) -> Int {
    if broken.isEmpty {
        return 0
    }
    let broke = broken.first!
    if springs.count < broke {
        // not enough left
        return 0
    } else if springs.prefix(broke).contains(".") {
        // We've got . here, invalid
        return 0
    } else if springs.count == broke {
        if broken.count == 1 {
            // Last spring
            return 1
        } else {
            // Invalid
            return 0
        }
    } else if springs[broke] == "#" {
        // We've got a bigger spring than what we came for
        return 0
    } else {
        return arrangements(springs: Array(springs.dropFirst(broke + 1)), broken: Array(broken.dropFirst()))
    }
}

public let day12 = Solution(
    part1: { input in
        let rows = parse(input: input)
        return rows.map { arrangements(springs: $0.springs, broken: $0.broken) }.sum
    },
    part2: { input in
        let rows = parse(input: input)
        let unfolded = rows.map { springs, broken -> (springs: [Character], broken: [Int]) in
            return (
                springs: (1...5).map { _ in springs }.joined(separator: ["?"]).map { $0 },
                broken: (1...5).reduce([]) { acc, _ in acc + broken }
            )
        }
        return unfolded.map { arrangements(springs: $0.springs, broken: $0.broken) }.sum
    },
    testResult: (21, 525152),
    testInput: """
???.### 1,1,3
.??..??...?##. 1,1,3
?#?#?#?#?#?#?#? 1,3,1,6
????.#...#... 4,1,1
????.######..#####. 1,6,5
?###???????? 3,2,1
""",
    input: """
?..#?.??#?...??##??? 1,2,2,1,5
?????????#? 1,4,1
????#?????.???# 1,3,2,4
#???#???##?? 1,9
??#???#??? 2,3
..?.???#.????.???# 1,2,4,1,1
??.???????#?#.??# 1,3,3,2
???#?????#?. 5,1
.???.???????????#?. 2,10
????#?.??#??. 5,1
.?.?.????#???????.?. 1,1,1,7,1
..#???????.?.??? 5,1,1,1,1
.???#?#?.? 4,2,1
?????##??#.???##??#? 8,8
#???..#.?#??# 2,1,2,1
?#??????.#?#?.?..# 5,1,4,1
????#.?.?#?? 3,1
#??????### 1,1,4
.?..??????? 1,3,3
#?#??#?#?##??#.?? 3,1,1,5,2
???#?.????.? 4,1,1
?#??#..???????.?#?? 2,1,1,1,1,4
#.##???.#??##????## 1,2,1,1,4,4
??#?#??.?????#??## 1,1,1,1,5,2
?#??#????#?#?#? 2,1,1,6
??#???????#?????? 7,1,1,1
???..??.?? 1,1
.??#??????#?????###? 2,8,3
??.???..#?.??#???? 2,2,1,3
????.????? 2,1,1
.#???##??##?#??.? 2,10
.?#????.#?? 2,2
?.?#???.#????#????#? 1,5,1,1,3,1
?###????..#??#? 6,1,5
?????.##?. 2,2
??#???????????#?? 1,1,2,4,4
?#?#??#?#.#?? 1,1,4,1
#??#?.?????# 2,1,3,1
?#?##..???#??#..??? 4,7,2
.????#?????#?.??. 1,8,2
??###??...#?###??.. 3,6
???#?#.?.??#?.? 3,4
?#?????#????#?? 1,9
???#.??..????.#?##? 1,1,1,2,1,5
???.?.????.. 3,1,2
.?????????#.? 4,5,1
?????.???.?#?? 1,3,2
?.??..????# 2,1,1
.?.???.????. 1,1,1,1
..???#?#??#.?.?#??? 7,3
#?#.#??#####??? 1,1,1,7
???????#??#?#???## 1,3,1,6,2
????????#????#?#?.?? 1,1,1,1,4,2
??????????????##? 1,2,1,2,4
??????###.??? 1,7,1
???#.??#????.? 1,4
????#?????.?#?#???. 10,5
.????????##????.?? 1,2,3,2
?.???.?.#. 1,2,1
?#?#.????.#. 1,1,1,1
.#.??????#?.#?? 1,1,2,2,2
??##??????? 2,1,1
?????###????#?? 9,2
????#.??.??###.?. 2,5
.?#????#.? 2,1
???#?.?.???? 3,1,1
.?#??#.??#???#?.?#? 4,8,2
.?#????????#. 7,3
.??##.??##..?.#? 4,3,1,1
.???.#.??????? 3,1,3,1
.????????#??.#??? 4,2,2,3
?###?.???#. 4,1,1
???#?.#???#??. 1,6
?.??#?.??# 1,2,2
?##???.#?? 2,1,3
??#?????#?#?#?? 1,1,1,6,1
?.?????#???.#?? 1,8,2
???.#?#??#?.? 2,4,1,1
?#????#???.??#??? 8,3,1
?.?..???????? 1,1,1,2
??#?#????#????#?? 1,1,6,5
?#?#?#???#.???#? 6,2,1,1
??#.?#.???#?.##?#? 1,1,1,3,5
#??.#?????? 2,2,1
????????#??. 2,1,2
?#?????#?#??.? 3,4
????#????#????#???? 1,14
.#?#??##??.#.??? 3,5,1,2
#??#???.???#?#? 7,2,1,1
##..#??????? 2,2,4
?#????.?????#??? 4,5
#???.????#???? 1,1,8
???.?#?.#??..?? 1,2,1,1,1
??#??#???.?????##?.? 8,4
??????..?? 2,1
???.??.#???#..?# 2,3,1,2
?#??..????.. 3,4
..#???.???? 3,2
???..????.??. 1,4
?????????.#???#? 7,1,3
?#?#???.??.. 3,1,2
.?????.?????#?#??# 1,3,11
#??###.?#???#? 6,1,1,2
??????.?#? 2,2,1
?????#?#??..? 3,1,1,1
????????????#?.?. 2,7
???.?.??????#??#? 1,10
??????????. 2,3
???##??#??. 1,8
???.?#???? 1,4
.???###..#?#?#? 6,3,2
??..??????. 2,5
#?????#??#???.#?.#? 2,3,3,2,1
.???#?????# 1,4,1
??##.??????.????? 4,1,1,1,1
.????????#?? 5,2
?.?????????#??????#? 1,6,1,1,3,1
?.???#?.????? 1,4,1,1
????????#?? 2,2
.??#???#???. 2,3
???...??#?#??????#? 1,6,1,2
??.????????? 2,3,1
?.#.??#?????#? 1,1,7
##??#??.???#??.?? 2,4,5,2
.#??????#?..?.??#?## 1,1,2,6
.??????????? 2,6
#????.??????? 3,3
?#??#?#.?#??.?#?? 2,3,3,1
???#?#?????#?.???.. 12,3
#.???##??..???.# 1,6,1,1
?#?###???#??????. 7,4,1
?.????????#??.#?? 1,3,4,2
???????????.. 3,2,1
?.?.?##?.? 1,1,2
.#.#?.???..??###. 1,2,3,4
?#?.??????.#?#???.# 1,2,1,6,1
.???.?????#?? 1,1,2,2
?????.#????#.# 3,1,3,1
?#???#?#?#??.?#??# 10,5
???..???.?????#? 1,3,1,1,1
???.#??#?#?????#??? 2,4,9
?????..???#?.#? 1,2,1,1,1
..???.#??#???? 2,1,3
???.?#?????. 1,1,1,1
????.???#???????? 1,1,1,4,5
?..?..??????# 1,1,7
??.?.?.###?. 1,3
????.?.?#???#????.#? 1,1,2,4,1,1
?????#??#????#?.#.# 3,4,1,2,1,1
????#??.???.???? 3,3,1,1
?.???##??.?#? 4,2
???.?..???.?#??#? 1,1,1,1,5
#???????.??#?##.??? 6,6,2
#????#??.??. 2,3
??????#??.?.?? 1,3,1,1
??????.???##??.? 1,4
??#????#??#??? 4,4,1,1
.#??.?#??????.?? 3,8
?#?..???##???#??. 2,6,2
??##?.???#??# 4,1,2,2
??????.?.?. 1,2,1
?.?????????.????#? 1,2,4,3
?????#????#?.?? 1,7,2
??#??????? 2,3
#??#?##??##??.?#???? 12,2,2
??#??#??#??##??????. 2,4,2,5
#??#?.?#??? 5,2
####??????????? 5,4
##.??#.?#?????? 2,2,3,2
##?????.??#?.?? 2,1,1,3,1
?.??##?##? 1,7
?.???.?#?##?#?#??? 3,7,4
??????..?#?????????. 5,4,1,2
?.??##?#??#??? 2,4
?.??????##?.#??#.? 1,2,1,3,2,1
#?.???#?#????# 2,4,1,3
#####???#???.??.??. 9,1,2,1
.#??#?#??????? 7,1
?????????#??# 2,2,1,2
?#?.?#?#????#????# 2,4,1,1,2,1
???????#??###? 2,10
??.?.?????#????.#.#? 2,1,4,5,1,1
????..#?.?#? 1,1,1,2
???.?????? 1,3
#???#?????#? 1,9
????????##???? 1,1,5,2
??.?#.?#?#??? 1,2,7
.?.?#?????????.? 8,1
????????.?????? 3,1
?????.??##? 2,1,5
##?????#????? 3,6,1
?#?#?..?.?##? 2,1,1,2
??????????#??..#? 12,1
?????#??#?.??#?.? 6,2,3
?.?.#??.?. 1,1
.?#??.???.#. 3,1,1
?.?#.????. 2,2
??#?##???. 1,6
..????#.?.?#? 5,1
?###?????????.#?. 4,1,3,2
???.?????#? 3,1,3
???###???#.??#? 9,2
?.??#???.??? 1,1,1,3
?#??????##??.#?#???# 5,5,3,3
#???#??.?#??###? 1,2,7
.?#?#???.?.??.?.##?? 7,1,1,1,3
??..#?.????. 2,1,1,2
??..?.??#?????.?? 4,1
????#?#?.#??? 7,1,2
.??????????#?? 1,9
??#..?????#.#.????? 3,2,2,1,1,1
??.##..??? 1,2,1
#..???????.##????#? 1,1,1,3,3,3
##.??#?????#??? 2,1,1,1,1
.###???##?????? 4,5,1
#.?##?????????# 1,4,1,1,3
?###.?.???#?????. 3,4
?#?????#???#. 2,1,2,1
.?.???????#? 1,1,2,4
.???????#?????. 2,4
.#..?.#??#??.? 1,2,3
?.?#??.?.? 1,1
?.???????#?? 4,3
.???????#? 2,5
????.??#?# 1,1,1
??.?????????## 2,4,1,2
#???#.???.????# 1,1,1,1,4
?#??????.?.#.??.???? 7,1,1,1,1,2
.?##?#???#?###.?? 13,1
?.##??##?.?? 6,1
.?????.??.????##?? 1,2,5
???#???##.? 1,6
???#??##?#?#?.? 2,1,7,1
?..????##?#?## 1,2,8
.?????###?..?..???? 6,2
#...????..???. 1,4,3
#?#?????..?.? 6,1
????#??##??#? 2,2,6
??#????#???##??????. 16,1
???###?.??##?? 6,1,3
?????????..#? 2,2,1,2
???????.???? 2,1,1,2
???????..?#?? 1,2,2
??????##?#?????#? 3,5,1,1
.?.??#??????#?.?? 3,2
??????.?#???? 1,1,1,6
????.##?#?## 2,7
.#?????##? 1,2
.??.#??.????### 2,1,4
????..#??.?????#?? 1,1,1,1,3,4
.????#?..#? 5,1
#????.???? 2,1,4
?##.??.?##?#??.? 2,2,7,1
#??#???#??#??## 1,6,5
???.?.?#?#???? 1,5,1
#?.?#?..?.#????# 2,1,1,4,1
????#..#?#??#????? 4,9
???#?#????#????.? 1,4,1,5,1
?.?????.#???? 3,4
?????#.????#??.?? 2,2,1,5,1
?????#??.#????.??. 7,1,1,1
??.?.????#?.??#??.? 3,2
??#?###??.#?? 6,2
?##????..#.??. 3,1,1,2
.?????##?#??#???#.? 8,5
#??#???###?.. 1,3,5
??????????#?????#. 11,1,2
###?#?#??..??? 7,1,1,1
#??#??#?#???..### 1,1,4,2,3
#?.????????.? 2,2
???.?????.???#.? 1,1,4,4,1
?#.?????##???? 2,2,2,1
??.#????#?????.?.. 1,1,8,1
????.?.???????. 1,1,1,2,1
.???????#????.???. 9,2
???#???#???????? 1,4,1,1,1
#??##.??## 2,2,3
?#??????.#??#??? 2,3,1,2,1
.????.??#??????..? 1,9
?.#?#?#??...???? 5,3
..?#????#?.???? 8,2
.#??#??.##??#??????? 4,1,5,2,2
#?.??#???#??? 1,10
?.#?????????? 5,4
?????????.? 2,4
#???.?#?#????.?### 1,2,6,4
#.??#?###??.?#??# 1,8,5
.?.???#??#??#??#???? 1,13
?#?#??#??#?????.??? 3,1,7,1
.?#.?#.?#??.? 1,2,4
????#.?#.???? 1,1,2,3
?????#.?#?????.?. 1,1,6,1
????.??????###... 2,2,5
??.?#?#.????. 1,3,1,1
???#.#??.? 1,1,2
???.?????????.??? 1,5,1,2
???????????.? 1,3
?????#????? 1,2,1
?.###????..??..? 1,3,1,1
???#.??#??? 1,1,3
?.?#??##?.?## 1,6,3
?????#?#?????.?? 2,8,2
??#.?#?.#..# 1,1,1,1
???#?#??#.????##?#? 8,8
.##?.?????.?. 2,2
??????????##?#??. 2,8
?##?.????????? 2,4,1
?#?#.??.??. 3,1,1
#..???.#?? 1,1,1
#.?#??#??#???#?#.?.. 1,13,1
#?????.?#??? 5,3
?#??#??#???#.#?? 1,6,1,1,1
#???..??????..?? 4,1,1,1,1
.#?#.?????????#?.??? 1,1,5,5,1
..##?#.#?????. 2,1,2,2
#??.?.#?#?##?????. 2,1,7,1
#???#??????? 1,5
?.??#??#?.?..??.? 1,5,1,1,1
???#??.?.??????#???. 1,4,1,1,6,1
???#????.?.?.?#?. 1,5,1,1,3
..???#??.#?# 1,1,1,1
.?###.?.?.#?#.#?? 4,1,3,3
???.?.??.????#.? 2,1,1,2,1
???.?.???? 2,2
????#?.?????#??.?##? 1,2,5,4
..?????.#. 1,1,1
?.???.????? 3,1,1
???????..????#.???.? 2,1,1,3,1,1
???.?..???#??#??? 1,1,8
?????????.???.????.? 1,2,2,2,1,1
.????.##?.. 1,2
#?????????.??#???# 7,1,1,1,1
?.?##..###???? 1,2,3,1
.????#???#?#.??. 1,2,1,3,1
??#.#????????? 2,1,3,3
???.?..?#...?? 1,2
??..??#??###??#?#??? 2,7,7
?????#???..#. 2,5,1
#???.???.?#????#??? 2,1,4,4
??.##?????? 1,2,1
?????.????..???#?. 2,2
?????.???#?#???? 1,2,6,2
?????..??.?. 1,1,1
?.????.??? 1,1,1
?????????????? 1,1,1,6
???#?????.??#? 5,1,1
??#??.#?#?##?#???#?? 2,1,6,1,1,2
???????.??.?.?#?.?? 5,2,3
?????#?????.??? 9,1,1
.???##??.#?? 6,3
???.?.??## 2,3
?.???#?##??.???? 1,1,1,3,1
????.?####???#??## 2,13
??????????? 8,1
#?.?##???#??#??? 1,10
???#???##?????????.? 11,1,1
.#?.??????# 1,3,2
#?#?.#??.?.#.??.#?# 3,1,1,1,1,3
?.???#?.??##?????? 1,2,2,3,1
??#??#???.#.??? 3,1,1,1,1
#?######???????# 11,1
#???#???#?????.#.#? 12,1,2
??#?#.????#?##?#??? 1,1,1,10
?.??#?.??.? 1,3,2
.?#??#?#?#??.?????? 9,5
?#??#????????#?.??#? 2,12,1
???#???????#?##? 3,3,4
#?#????.????#??# 4,1,1,5
???##?##????#.???? 8,2,2
?????????.#?.###..? 1,7,1,3,1
.#?????.?#?? 6,1
#???#?#??#? 8,1
????#?.#.. 1,1,1
?#??#?#?.?????#? 1,1,1,3,2
.?.?????##?#??##??? 1,1,13
?.??????#????? 7,3
?..?.?????#??? 1,2,2
?.?????##??.???#??. 1,1,5,1,3
????#?#??????#????.? 3,6
??##??????? 4,2
??.?#??#?????????.?? 5,4
??#?#.?##?? 3,3
?#??.??..?? 2,2,1
????...?.??????#.#? 1,1,1,5,2
????????###.? 2,6,1
?.#?#??????#? 1,10
?.?##??????.???? 1,6,1,1
#???????##?? 6,2
??##???.?.?#??#??##. 5,1,8
?##..??##??#?. 2,5,1
#.??.#????#?#?? 1,1,1,1,6
.????..??#?. 1,1,4
?..????????.#.. 2,1
???#???????#??? 5,1,4
???.???.???? 2,3,1,2
??..#???##.??. 1,1,3,1
?????.???????????# 1,1,1,1,7,1
#???#???#????. 1,6,1
##??#??????.?? 5,3,1
.???#?..???.??? 5,2
.?##?##??#?.#??#? 3,6,1,3
.??#.??#???.??? 2,5,1
.#.???#??##?#.????? 1,7,1,1,1
##?.#???##?#??? 3,10
#??.??###.?#.## 2,4,1,2
??#???????#?.???# 5,6,1,1
????##?#???.??# 2,4,2,2
#?..???##?.? 2,5
..????#??.? 2,2
.???#?????. 2,1,2
?#?..??..#???. 2,1,1,2
????.???##????????. 1,1,1,10
#?#?#.#???.?#? 1,3,3,2
..##??????.????? 4,1,2,1
??#???????? 4,2,1
???.?????#. 3,1,1
.#?????????? 3,5
.???.???.?##???##?.# 1,2,8,1
???###??#..???#????? 8,6
?????.?????# 1,1,1,1
???#.??##?#?.?.???? 1,1,4,2,1,1
?.##?###???.???????# 1,9,1,2,2
..?.??.??#????????? 1,6
???##???#??????# 5,3,1,1
.#??.???.?####?? 3,2,6
??##??#.?#?.#??#???? 6,1,1,2,1
.???#??.????##?? 5,7
.?????#?.??# 1,1,2,1
??..#???.???? 1,1
?.??###???#.?.#???? 1,4,1,1,1,1
??.?#.???? 2,1,1
????#???.?#..###? 5,2,4
???#????#? 3,2
.?##??##???#?#?????? 9,1,1,3,1
??#??..??#?#.?? 1,1,1,5,2
#????#.???????? 1,4,1,1
??##.??###??# 2,1,3,1
???#?#??#? 1,1,1
????????.??.?.#.#? 5,1,1,1,1,1
?#??.??#.?.??#? 3,1,1,1,2
?##?.#??#? 2,4
???#????.?.?? 6,1,1
?.???.???????? 1,1,6
??.??.?.???..? 2,2,1,3
?????#..?????. 1,1,2
??#???#??#?#.?.? 1,10
.??#????##?????. 5,3,1
?.#?.??#?#? 2,1,4
?.?#?####?.?.???.?.. 8,1,2,1
??????#??.? 5,1
?#??#????????? 5,1,1
?..?????????###??? 1,1,1,3,7
????????.?.?..?????? 1,1,4,1,1,5
..?????.#???#..# 2,1,3,1
???##????#.?.?#? 8,2
#.???.###? 1,2,4
?#.??..????## 2,1,1,4
..??..#??. 2,2
????.?.#??? 2,1,1
??#??##??????.??#??? 10,1,1,1,1
.##?..#?.?..#?#?..?. 2,2,4
??..??????#?#. 2,2,3
??????#???.##?##?? 1,5,1,6
???#?.#???# 3,1,2
#?????#?##?#.????. 3,7,4
??#??#??#?#.?. 2,2,4,1
#???????.. 4,1
???.?.?###? 2,1,3
?#?.?????##?#.#??. 3,1,2,2,1,2
?#??????#.?? 1,1,2,2
.#.?##????## 1,3,3
.#?????????? 2,6
?.????.??# 2,2
..?##??.??.?##? 2,2
???##?#????# 8,1
.????#????.?. 7,1
?.???..#?#??? 2,4
?#???.#?????..#??## 4,3,1,2,2
?????.?#??.???.? 1,2,3,1,1
?.?#?????#???.. 1,2,1,1,1
?#???#?#?.???#??#??? 9,1,7
?????????. 4,1,1
..#??.??.?#???#.?? 2,6
.??????.?# 1,1,1
???#..?#???#?##??# 1,1,10,1
?.??..?#?? 1,2,1
???#?.??#?? 3,5
??#????????#? 3,1,2
????????##?????#??. 6,2,1,3
????#???.?#???.? 4,1,1,2,1
.?#?????....?#??.??? 1,2,4,2
???##???##?#???.? 12,1
?.??????.? 3,1
?.?...###????#?? 1,10
??#??????#?.? 4,2
.##?#.#????.? 2,1,1,1
#???.????.?## 1,1,1,2
?.?#?.??##??????? 2,2,3
??.??????##?.??? 2,1,7,1
?#??.???????????? 4,1,6,1
?#??..???#?? 3,1,2
.???.???##.? 2,4
#???#??#.? 2,2,1
????#????? 2,3,1
?????#?..?????? 2,3,2
????????#.??.??..?? 7,1
?????#??#.?#???? 1,3,1,5
????????#?? 2,1,1
????.#?????.???.???? 1,1,6,1,1,1
#????#?##?#?#??? 1,12
???#??#??.???????? 5,2,1
#???.#??.?.. 1,1,2,1
?.?????#.?.??. 3,1
#???.???????.??? 2,1,2,2,3
.#??????#### 1,7
?.?.?????#???? 1,2,1,2
?????.##???##? 3,7
??##????#??????.?? 5,1,1,1,1,2
.#?#?????. 1,6
.?#??.???? 2,3
#.??#???#?????.#?#.? 1,11,3,1
.?.??#?#?????###?. 8,3
??????.???. 4,1,2
.#??.?????#? 1,1,2,4
???#.#?#?#? 4,1,3
??###..#?? 3,2
????????#??.#? 3,2,1
.????##??..#??. 1,3,3
?????.#???.???#???? 2,2,1,2,3
??.???.????????#?.# 1,1,4,4,1
?.??.??##????#???# 1,1,13
.??#?#??..?##???? 3,6
????#??.????##.. 3,1,1,1,2
??.?.????#?.? 1,1,2,1
????????#?#?#???? 4,11
.??#?##?.?.?? 7,1,2
???????????#????#? 2,1,1,2,7
??#??????? 1,3,1
###?.#?????#? 3,1,1,3
????#?#?##??. 1,8
??????##?##??#????. 1,2,9,1
?.?.??????#? 1,1,3,3
??????.#?#.??#? 1,1,1,1,2
.??#??????????#.?# 6,1,1,1,1
?#??#?#????.???. 7,1,1,1
?.??#????#??.??.??? 1,1,1,6,1,2
???.#.#.??.#.?#???? 1,1,1,1,1,5
.#?.??????#????.??# 1,2,6,1
.??#?????? 1,1,2
.#??#????????.?????? 10,1,2,2
.#????.?##? 1,1,3
???#?##???.?#????#. 6,1,6
??.???#??.??#?#?... 3,3
#?#?.?#???.?. 1,2,3
????.?#?#????#?#. 1,10
??????.#?.?? 2,2,1
?.##?..??.??##???? 1,2,2,1,2,2
.??#??.?????.??? 3,2,2
????#?#.?#??# 1,4,4
???#????.?#.?.? 2,1,2,1,1
???????????.#???. 4,1,1,1,4
#????#?#?..??? 8,3
?.???????. 1,4
?#??#???????????? 6,1,2,1
?#?????#.??#?##??. 1,3,7
..???##??#?????????. 10,2
????#??#.??.????? 1,6,1,1,3
?.???.???????.??.. 1,3,3,1,1
.????????? 2,2
??.#?.?#????.?..?? 2,6
?.???#????### 1,5,4
?.??#????? 3,1
??#???#.??#?? 2,1,1,1
????##????????##? 1,2,4
??.???#?.??? 1,1,2,1
???.???#??.#????. 1,5,1,3
.?#?????????? 2,2,1,1
##???.???#.##?### 2,1,3,6
?.?.#?..??#?????#?.# 1,1,1,7,1,1
.#????.???#????. 4,2
?#????#???#??? 1,2,1,4
??##???#???#???? 5,5,1
????#??????#??? 7,3
.#???#?.???????.#. 3,1,1,1,1,1
????#?????..?.??? 9,1,1,1
.#?#?#??###?????.? 1,1,1,8,1
?#???#.????. 1,1,1,1
??????.????? 3,1,1
.????????..? 2,1,1,1
?????#?#??#. 2,6
??????#???###???? 7,4,1
..??##?????????#??. 6,2,1,1,1
??#??##??.??#.???? 8,1,1,1,2
?????###?????#?#? 9,5
??..??#?.. 1,1,1
.??.??????????##??? 1,4,6
#?.?????#??#.??.??? 2,3,5,1
?#??????#?#?? 2,3,1,2
.??#??#????#?#.? 1,8
..??.??.????## 1,2,1,3
???###???# 4,2
???.????#?#??#?#??? 3,2,10
?#?.#.?.?####? 2,1,1,6
???..???.#???????? 2,1,3,2,1
??.?.?#??.#??# 1,2,2,1
???##??### 2,2,3
?#????.?#??????.?#?? 5,1,2,1,2
..????#???# 1,2,1
????#..??##??? 1,1,1,3
##?#??##????#?.?? 10,1,1
#???###?????? 7,1,1
??????.??#?????##?? 4,1,5,1
?.??????#???? 1,3,4,1
???????#?##???..?. 1,1,8,1
??#??##?#?#????. 9,1
????###????????.?.?# 3,5,4,1,2
??.?#???.?.??????. 1,1,2,1,4
##???###.?????##..# 3,3,1,2,2,1
??#??#?#.?.??#????? 6,4
#?#???????#??#?#?#?? 3,1,2,4,1,2
???#?????.?. 1,1,1,1
?#.?#.????? 2,1,2
???#??#?#??#?##??.? 4,1,9,1
?...##????.??#?.? 1,3,1,3
??.?.??#?#??#. 1,6
???.#.??#???.? 1,1,2,1
.??..???#?#???? 2,6,1
?##??#?.?? 5,1
#??#??#????.. 1,7
??.???#?..#?#?????. 2,8
???????#??#.???#? 1,1,3,1,2
???????###?#. 3,3,1
???.#?##????#?#?#? 1,5,8
#.?????#??.???.#?? 1,1,3,3,3
#??#???????????#??? 1,2,4,1,2,1
???.?#.?###?.#.?# 1,1,4,1,2
???#?????.?#???#? 4,3,1,3
?#??.?..?#???? 4,3
??#?#.#.?? 4,1,2
???????.??#.?#? 1,2,1,1,2
#?#?##???.????#?? 1,7,1,1
??#??#?????#??. 7,2
.?.??#?.???.?# 1,3,1,1
.?.?????#????##?.. 1,1,1,3,3
#.????.???????.?? 1,3,4,2,1
???????#???????.??#. 1,2,1,4,1,1
.?#?..??##. 2,4
.?#????????.?????? 9,6
?#????????.???# 3,3,1,1,2
??.???#???? 1,3
??#????????????? 8,1,2
?????#???????#???#? 3,2,1,5,3
??.???.???###? 1,2,6
?#..???#..? 1,3,1
??#?#??????#.#.??? 10,1,2
???.??#???##??#???. 2,10
?..??..?.??#?? 1,4
????.??.???. 3,1,2
???##??..??. 5,1
??????#.??#????? 1,1,5,1
???#???#????#?#???? 1,1,4,1,7
.?..???#?.? 1,1
?.???#??#?????##???? 1,2,5,7
?#???.???#??.?????# 2,2,3,5
????#????.#?.#? 1,5,1,2
??.?#?#.?? 2,3,1
?.?#?????#??. 5,2
.????..????????? 1,1,1,1,4
?#.????.#??. 1,2,2
????..#??#?#?##? 1,9
.?###????? 4,1
?????#?????#?##.? 4,4
#?.#??.????????##? 2,2,2,8
????.????????#?... 2,1,1,3,2
??.???.?.??. 1,1,1,1
?##?.????##??##??? 3,2,8
?????????#??#?????? 3,9,3
#?.#??#?.?#????? 1,1,3,2,1
???.#??#????#???.?? 1,1,6,4,2
???#...###??????. 4,5,3
???????#...?? 2,4,1
#??#?#??#?#?. 7,3
?.?###????###??? 3,7
??#..?????????? 2,2,2,1
.??????????#?? 1,1,1,3
#??#?????#???.??#?? 10,2,1
?..?.#??#.??? 1,2,1,1
#..?????#..# 1,1,3,1
#?#.??#???#?? 3,3,1
#??#????#?.???.??? 1,1,3,1,1,1
?.?.??????#?#.#?#? 1,1,1,5,1,2
#?.?#????#? 1,2,5
??????..#??#?????.? 1,1,1,5,2,1
????#??#????? 4,5,1
?..?????#??#????.?? 1,10,1,1
??#?#???.??????? 6,1,2
#?.??#??#?. 2,1,2
????#.??.??? 1,2,1,1
?#?#.???#?? 1,1,2
?.#??.?.??# 3,3
.?#.###?#????#?.##.? 1,11,2
?.????#????.???#?? 1,1,1,1,1,3
#.?#??.?#??#??? 1,2,5,1
.?#????????.??# 5,1,1,1
???.#?.????? 2,2,2,1
#????#??#?#??.???? 13,1,1
?#?#?????? 4,1,1
???##??????.??.???. 5,2
?.????.?..#. 1,1
???????.???#?#?##.. 1,2,8
.#.?????#.?.#?????.# 1,4,1,1,1,1
???##?.?????? 4,4,1
?????#???####? 2,9
.????#.????.# 5,2,1
??#?..#?#???# 2,1,2,1
??##.#??#?#????#?. 4,2,1,1,2
#.#???.?...?#????#?? 1,1,1,1,7
?.????.??????#?.#? 1,2,1,5,1
??#???.???#??. 1,1,3,1
?##?#?#???#.#???? 10,1,1,1
.?#???????????. 1,2,5
???????..??#?#??? 5,1,5,1
.???.#?#??????##??#. 1,14
?#??.?.???.#? 4,1,3,1
..??##???????#.?? 5,5,1
.#?????#??? 1,5,1
#????#.?.?????. 3,1,5
?#?##?#?????# 5,2,3
???????#?.?..?????.# 7,1,3,1
?#??#??.?? 1,4
???#..???. 4,2
??.#?#.?#?? 1,3,1
???#??##??.#???#? 2,3,5
???#?????#??.???.?.? 11,2
.??..???#??? 2,4,1
?.?#.?##?.?#?.? 1,2,2,3
??#??????#?? 3,3
.?#??#???? 2,5
????.??????#???#?.? 3,2,7,1
???#?..#?.?#???#?#? 2,2,2,6
.??#??#?#.??.#? 2,1,1,1,1
.?###..????#? 3,2,1
?.?????????? 1,4,1,2
?#??#???..???#? 6,4
???#??#??.#? 3,1,1
???.?.####?.# 1,1,5,1
.?????????.?.? 5,1
.???????#???#?. 1,9
.??#??#???.??#. 4,1
#??#..##?.???. 4,2,3
.????.??.?#?.?.?#?. 4,1,3,1,1
??.?#??????#??????.? 1,3,3,3,1,1
#?????.?#?.#??.? 1,4,1,2,1
?.?????????.? 3,3
?????#???#?? 5,1
..??#???#???.#.#.? 6,1,1,1,1
??.#.##??? 1,1,4
?#??????##.##?. 1,2,3,3
.???#.????? 3,3,1
.???#?#????#??.?.?? 7,1,1,1,1,1
..??#??#??#???.?##?. 6,1,3
??#???#.???????? 7,1,3
???.#??.???.???# 1,1,3,1,2
??#.##?#?? 2,5
.???#?#.#???????? 4,1,2,2,1
?#?#.?##????#? 2,1,4,2
?.?.?.#????#??.?? 1,1
.???.#????.?.?????. 2,5,5
?#?.??.????? 2,1,3
????###?#?.????.#??. 7,3,1,1
?..?#?.##? 2,2
?.?????.##???#.??## 1,1,1,6,1,2
??#?.?.#???.? 1,2
???.#?.#?????#. 1,1,2,2,4
..??????????#? 1,8
??##?#?.???? 3,1,1
?#?.???#.?? 2,1,2
##???##?#???.?? 7,2,1,1
???##??##??#.?.???? 11,1,1,1
??.??????##??.#..?? 1,6,1,1
????#?#?.??#?? 6,1,1
.???.#.#??.?#? 3,1,2,2
??????.??#.??.?#?.? 5,2,2,3
?.??#?????#.?#??##. 1,3,1,1,1,6
?.???#???#?#?.????? 2,1,6,1,1
#.##?????????#? 1,3,1,2,2
?.#??????. 4,1
????.??.????#?????#? 3,1,1,1,6
??##?#?##???# 9,1
?#?####.####??? 6,4
??.#??.????# 1,3,2
.????#??.?#?? 6,3
??????###?.???.??? 2,4,1,3
.??#??.????#?? 4,1,1
??.#?????#???????# 1,5,3,1,1
???????##?#??#??#??? 1,10,1,2
????#??#?####?.#. 3,2,5,1
#???##???#.?.???# 7,2,4
??#??.????? 3,3
?#??..?????. 1,3,1
???#???#.??.?##?. 6,3
??#??.??.??.#. 4,1,1,1
??????.??#?#??..???? 1,3,5,1,2
??#?##??#.??.?# 6,1,1
###????.#????.##.? 3,3,1,1,1,2
#?#?#?#?#??#???????# 1,1,3,6,2,1
??.#???#???????? 5,6
?.???????.? 1,1,2
?????????????? 1,5,2
????????#? 2,3,2
???.???.?###??#?? 2,1,4,1,1
????????#?#??? 6,3
???????#??.? 1,1,4
.#??.#?#??? 3,4,1
???###????.????#. 7,2
.???#?????? 1,3,3
???????????????#.?#? 2,2,6,1
.###??..?? 3,1,2
?..????#.????.??#. 1,5,2,1,1
??#????.??#???.. 2,4
###???.??#?#?..???? 6,6,1
?#????????. 4,4
?#??????????? 5,1,1,1
??..??.#????. 1,5
?.?##.?????? 2,5
..??????#?? 3,1,1
???????#???????#?. 2,9
?.?.#?.?#.??#?#??# 1,1,2,1,8
????##???#?????..??? 11,1,2
?.??.??.#?? 1,1
.??#???#?#?#?.??# 4,5,1
#??#??.??.##?.#??# 5,1,3,4
.#.##??.???????#?##? 1,3,4,7
..??.?#?#???#?#?.? 1,1,3,4
.??.##???..???????#? 5,1,7
??????...# 2,1,1
?????#??.#.? 1,2,1,1
??#???#?#??#??? 9,2,1
????????#?????.. 2,8
?????.?#???#..?#???? 2,1,4,1,3,1
.?????.??#?? 3,2
#?????#?#.#???#?? 3,3,1,2,2
??#????###????.???? 11,1,1
.??.????.??? 1,2
#.#???#????#???.#.?? 1,7,1,2,1,2
.#.###????? 1,6
??????##?.?..?#?. 7,1,2
.###?#??????#???? 5,7
??#??#.##??.?.??# 4,4,1,1
???????#?#?? 1,5
??????????##.??? 1,4,4,3
#?##????..??# 7,1,1
#?????#??#????.?? 1,1,5,1,1
.?#?#.#?.??????#?? 3,1,1,1,5
?.?#.?##???#..#. 1,5,1,1
#??#?????.#?.?????. 6,1,1,1,2
.?#???.??##??.?? 4,6,1
??????#???#???????#? 13,1
??#??##???????.???? 9,2,1,1
#?#???#..#??????? 7,1,1,1
????????.?#??#??. 2,6
?.???.##????#?####?? 2,2,8
?..##?????#?????#? 2,2,7
..???.???.# 2,1
???#.????.? 4,3,1
##?????#????.?????? 2,5,3,3,1
????#??##?. 3,2
??#??.?#?..????.?? 5,3,1
.?..?????..##???.??? 1,4,2,1,1,1
.??????##???????? 7,1
??.?????.? 1,4
....??.???# 1,2
.??.????????????? 1,9,1
??#?#????#.??#????#? 9,9
??.#??#??.?? 4,1
??.??#?????? 1,6
.#?###..#???????.? 5,1,6,1
.????????.??.?? 8,2
#??#.?#??#??.#? 4,4,2
?.????.????????#?. 3,9
??###????????? 8,1,1
?#.##??.#? 1,2,1
????????.#??#. 8,1,1
?..#?.?..##???##??? 2,10
.?##?##???.??????#?? 6,2,1,4
?.????.??.##???.?? 2,2
.????.?????#???? 4,6
???.??????? 2,2,4
????.?#?????.???#? 2,5,5
?.#??????????..?#.?? 1,5,1,2
????#.?###?????##??? 5,12
??.??#???????#????. 1,1,1,4,2,1
.?????#???? 1,4
???##??????## 6,2
#?#?????.???.?#?.? 4,2,3,2,1
??#?##?##?#?????#?? 9,1,5
?????#??## 5,2
?#.????#??#????#?? 1,1,4,1,4
??.??????#?#.?? 2,8,1
?????.????. 1,1,2
..?.??????????????? 1,1,1,4,1,1
?.?#??#???????#???.? 7,6,1
???##?.#???#?#??? 5,2,6
?##?##??????? 6,4
##?.#??#?. 3,1,1
?.?#?.??#.?? 1,1,1,1
?.???#?##?????#. 1,8,1,1
?.?.??????#???## 1,1,1,1,4
.???##???.# 4,1
??#?##???.. 7,1
#.???#?.#.???? 1,4,1,2
?.?#????#?? 1,2,4
#?.#????#??????????# 2,1,1,4,1,5
??????.?#??.?##? 3,1,2,1,3
???#???.???#?#?#??. 3,6
#??.??#..? 3,1
????.???????? 2,1,1,1
??.??#?#..???????? 1,4,8
##?.?????? 2,2
?..#?.##????????# 1,1,11
.#?#???.?#???.?? 1,1,2,2,1
???????.??##?? 2,1,4
???#?.#???????##? 2,2,1,7
???????.??.??. 2,1,2,1
?..?#?..???#?? 2,1
???#?.#?.????#?.??? 4,2,5,1
??#??.#???#??.?#?. 4,1,3,1
?.????..?????#??# 3,1,5
???##??#???#.?? 1,5,2,1
?????.???. 2,1
?????#.??.?? 6,1
?#????????. 1,5
????.???#??#????.# 4,2,1,3,1,1
?#.?#?#.##?????##? 1,3,9
????.???#.#?##??.? 1,1,4,1,4,1
#.??.?.??##????#?#? 1,1,1,5,1,2
???.?????##?#?? 1,4,2,2
????#?.?.? 1,1,1
?#??.?...?#???????.? 2,1,8
??##???##?? 4,2
????#??#??#??#??? 11,1
#?????????##???? 4,9
????????#????#??#?? 1,15
???.#?.?#? 1,2,1
?.#..#???#??. 1,1,2,3
?.???????? 2,4
????????#????#?.? 1,1,7,1
??..????????.?.??#?? 7,3
#??????#??##.. 1,2,1,2
?.?##????#.?...?. 3,1
#?#?#?###??##?#? 9,2,2
?.##???#?#???#?#?? 2,12
##?.?#.#????#?? 2,2,7
????#?#??#???. 5,1,1
?????#.?.###??.??? 6,4,3
????#?###??. 1,1,3,1
?????#??.?#????. 1,5,2,1
???.??#??#?.??#?.??. 3,7,3,1
.?#?.?#..?#?##??#.?? 3,1,7
?.#????#.????#?#? 3,1,1,6
#??.?????..????.???? 1,4,1,2,3
?###????..?##?? 8,4
.#???????#?##?#?? 1,1,1,1,5
???##?????#?#??#.?.# 1,11,1,1,1
?????????? 2,2
????#??.#??? 6,1
#????????????.?##? 4,1,2,2,2
?.?##?#????#???#?#.? 1,4,9
?#.?###?.??????#??.? 2,3,8,1
?????..#?..?? 3,1,2,1
#?#?#?#?????.?# 5,1,1,1,1
?#???#??.#??# 1,4,4
??#??#?##?? 2,5
????#.#???#???#??.# 1,2,3,6,1
#???..#?#???????.?# 3,1,2,1,1,1
?????#????? 1,4,3
?????.?????#?#????. 2,1,1,5,1
???#??????#. 2,3,2
#??.?????? 1,1,4
.?#?????.???????? 3,1,1,4
#.???????????#?????? 1,4,1,1,3,1
?.?###?#?????#??. 4,1,6
?#?##??????? 6,1
.????#?#### 1,2,4
???..?#?????? 1,1,1,3
?#?.??.?.#???#??? 2,1,2,4
#?????????.?#??#??? 2,2,2,1,1,1
???#?????????. 1,3,5
##.??.#.?.?##??#? 2,1,1,7
.???##?.?.##? 4,3
??##?????#???#? 4,7
.?.??????##?..?????? 8,1
??#???????#???.?? 1,1,1,5,1
.#??#?#???????#???. 1,4,1,2,1,1
??.????#?.##. 1,2,1,2
?#?????#??.???#?. 2,2,3,3
?#?????#??????#..? 13,1
??#.???#???#??..?#? 1,9,2
##??.?...?????#? 3,1,1,1,2
#?.??#??.? 2,2
"""
)

